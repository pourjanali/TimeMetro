// =====================================================================
// ||               داده‌های مترو (جاسازی شده از CSV)                  ||
// =====================================================================

// داده‌های فایل: MetroTimeSheet.xlsx - روز عادی.csv
const csvDataNormal = `
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
حرکت از ایستگاه به سمت ایستگاه نور,,,,,,,,,,,,,,,,,,,حرکت از ایستگاه به سمت ایستگاه ائل گؤلی,,,,,,,,,,,,,,,,
 ائل گؤلی, سهند, امام رضا(ع), خیام,29بهمن, استاد شهریار, دانشگاه, آبرسان, سالار ملی(قطب), شهید بهشتی (ره), میدان ساعت, میدان کهن, قونقا, گازران, لاله, امام حسین(ع), شهید باکری, نور,***, ائل گؤلی, سهند, امام رضا(ع), خیام,29بهمن, استاد شهریار, دانشگاه, آبرسان, سالار ملی(قطب), شهید بهشتی (ره), میدان ساعت, میدان کهن, قونقا, گازران, لاله, امام حسین(ع), شهید باکری, نور
05:55:00,05:57:00,05:59:00,06:01:00,06:03:00,06:05:00,06:07:00,06:09:00,06:11:00,06:13:00,06:15:00,06:18:00,06:20:00,06:22:00,06:24:00,06:26:00,06:28:00,06:30:00,,06:50:00,06:48:00,06:46:00,06:44:00,06:42:00,06:40:00,06:38:00,06:36:00,06:34:00,06:32:00,06:29:00,06:27:00,06:25:00,06:23:00,06:21:00,06:19:00,06:17:00,06:15:00
06:15:00,06:17:00,06:19:00,06:21:00,06:23:00,06:25:00,06:27:00,06:29:00,06:31:00,06:33:00,06:35:00,06:38:00,06:40:00,06:42:00,06:44:00,06:46:00,06:48:00,06:50:00,,07:10:00,07:08:00,07:06:00,07:04:00,07:02:00,07:00:00,06:58:00,06:56:00,06:54:00,06:52:00,06:49:00,06:47:00,06:45:00,06:43:00,06:41:00,06:39:00,06:37:00,06:35:00
06:35:00,06:37:00,06:39:00,06:41:00,06:43:00,06:45:00,06:47:00,06:49:00,06:51:00,06:53:00,06:55:00,06:58:00,07:00:00,07:02:00,07:04:00,07:06:00,07:08:00,07:10:00,,07:30:00,07:28:00,07:26:00,07:24:00,07:22:00,07:20:00,07:18:00,07:16:00,07:14:00,07:12:00,07:09:00,07:07:00,07:05:00,07:03:00,07:01:00,06:59:00,06:57:00,06:55:00
06:55:00,06:57:00,06:59:00,07:01:00,07:03:00,07:05:00,07:07:00,07:09:00,07:11:00,07:13:00,07:15:00,07:18:00,07:20:00,07:22:00,07:24:00,07:26:00,07:28:00,07:30:00,,07:50:00,07:48:00,07:46:00,07:44:00,07:42:00,07:40:00,07:38:00,07:36:00,07:34:00,07:32:00,07:29:00,07:27:00,07:25:00,07:23:00,07:21:00,07:19:00,07:17:00,07:15:00
07:10:00,07:12:00,07:14:00,07:16:00,07:18:00,07:20:00,07:22:00,07:24:00,07:26:00,07:28:00,07:30:00,07:33:00,07:35:00,07:37:00,07:39:00,07:41:00,07:43:00,07:45:00,,08:05:00,08:03:00,08:01:00,07:59:00,07:57:00,07:55:00,07:53:00,07:51:00,07:49:00,07:47:00,07:44:00,07:42:00,07:40:00,07:38:00,07:36:00,07:34:00,07:32:00,07:30:00
07:25:00,07:27:00,07:29:00,07:31:00,07:33:00,07:35:00,07:37:00,07:39:00,07:41:00,07:43:00,07:45:00,07:48:00,07:50:00,07:52:00,07:54:00,07:56:00,07:58:00,08:00:00,,08:20:00,08:18:00,08:16:00,08:14:00,08:12:00,08:10:00,08:08:00,08:06:00,08:04:00,08:02:00,07:59:00,07:57:00,07:55:00,07:53:00,07:51:00,07:49:00,07:47:00,07:45:00
07:40:00,07:42:00,07:44:00,07:46:00,07:48:00,07:50:00,07:52:00,07:54:00,07:56:00,07:58:00,08:00:00,08:03:00,08:05:00,08:07:00,08:09:00,08:11:00,08:13:00,08:15:00,,08:35:00,08:33:00,08:31:00,08:29:00,08:27:00,08:25:00,08:23:00,08:21:00,08:19:00,08:17:00,08:14:00,08:12:00,08:10:00,08:08:00,08:06:00,08:04:00,08:02:00,08:00:00
07:55:00,07:57:00,07:59:00,08:01:00,08:03:00,08:05:00,08:07:00,08:09:00,08:11:00,08:13:00,08:15:00,08:18:00,08:20:00,08:22:00,08:24:00,08:26:00,08:28:00,08:30:00,,08:50:00,08:48:00,08:46:00,08:44:00,08:42:00,08:40:00,08:38:00,08:36:00,08:34:00,08:32:00,08:29:00,08:27:00,08:25:00,08:23:00,08:21:00,08:19:00,08:17:00,08:15:00
08:10:00,08:12:00,08:14:00,08:16:00,08:18:00,08:20:00,08:22:00,08:24:00,08:26:00,08:28:00,08:30:00,08:33:00,08:35:00,08:37:00,08:39:00,08:41:00,08:43:00,08:45:00,,09:05:00,09:03:00,09:01:00,08:59:00,08:57:00,08:55:00,08:53:00,08:51:00,08:49:00,08:47:00,08:44:00,08:42:00,08:40:00,08:38:00,08:36:00,08:34:00,08:32:00,08:30:00
08:25:00,08:27:00,08:29:00,08:31:00,08:33:00,08:35:00,08:37:00,08:39:00,08:41:00,08:43:00,08:45:00,08:48:00,08:50:00,08:52:00,08:54:00,08:56:00,08:58:00,09:00:00,,09:20:00,09:18:00,09:16:00,09:14:00,09:12:00,09:10:00,09:08:00,09:06:00,09:04:00,09:02:00,08:59:00,08:57:00,08:55:00,08:53:00,08:51:00,08:49:00,08:47:00,08:45:00
08:40:00,08:42:00,08:44:00,08:46:00,08:48:00,08:50:00,08:52:00,08:54:00,08:56:00,08:58:00,09:00:00,09:03:00,09:05:00,09:07:00,09:09:00,09:11:00,09:13:00,09:15:00,,09:35:00,09:33:00,09:31:00,09:29:00,09:27:00,09:25:00,09:23:00,09:21:00,09:19:00,09:17:00,09:14:00,09:12:00,09:10:00,09:08:00,09:06:00,09:04:00,09:02:00,09:00:00
08:55:00,08:57:00,08:59:00,09:01:00,09:03:00,09:05:00,09:07:00,09:09:00,09:11:00,09:13:00,09:15:00,09:18:00,09:20:00,09:22:00,09:24:00,09:26:00,09:28:00,09:30:00,,09:50:00,09:48:00,09:46:00,09:44:00,09:42:00,09:40:00,09:38:00,09:36:00,09:34:00,09:32:00,09:29:00,09:27:00,09:25:00,09:23:00,09:21:00,09:19:00,09:17:00,09:15:00
09:10:00,09:12:00,09:14:00,09:16:00,09:18:00,09:20:00,09:22:00,09:24:00,09:26:00,09:28:00,09:30:00,09:33:00,09:35:00,09:37:00,09:39:00,09:41:00,09:43:00,09:45:00,,10:05:00,10:03:00,10:01:00,09:59:00,09:57:00,09:55:00,09:53:00,09:51:00,09:49:00,09:47:00,09:44:00,09:42:00,09:40:00,09:38:00,09:36:00,09:34:00,09:32:00,09:30:00
09:25:00,09:27:00,09:29:00,09:31:00,09:33:00,09:35:00,09:37:00,09:39:00,09:41:00,09:43:00,09:45:00,09:48:00,09:50:00,09:52:00,09:54:00,09:56:00,09:58:00,10:00:00,,10:20:00,10:18:00,10:16:00,10:14:00,10:12:00,10:10:00,10:08:00,10:06:00,10:04:00,10:02:00,09:59:00,09:57:00,09:55:00,09:53:00,09:51:00,09:49:00,09:47:00,09:45:00
09:40:00,09:42:00,09:44:00,09:46:00,09:48:00,09:50:00,09:52:00,09:54:00,09:56:00,09:58:00,10:00:00,10:03:00,10:05:00,10:07:00,10:09:00,10:11:00,10:13:00,10:15:00,,10:35:00,10:33:00,10:31:00,10:29:00,10:27:00,10:25:00,10:23:00,10:21:00,10:19:00,10:17:00,10:14:00,10:12:00,10:10:00,10:08:00,10:06:00,10:04:00,10:02:00,10:00:00
09:55:00,09:57:00,09:59:00,10:01:00,10:03:00,10:05:00,10:07:00,10:09:00,10:11:00,10:13:00,10:15:00,10:18:00,10:20:00,10:22:00,10:24:00,10:26:00,10:28:00,10:30:00,,10:50:00,10:48:00,10:46:00,10:44:00,10:42:00,10:40:00,10:38:00,10:36:00,10:34:00,10:32:00,10:29:00,10:27:00,10:25:00,10:23:00,10:21:00,10:19:00,10:17:00,10:15:00
10:10:00,10:12:00,10:14:00,10:16:00,10:18:00,10:20:00,10:22:00,10:24:00,10:26:00,10:28:00,10:30:00,10:33:00,10:35:00,10:37:00,10:39:00,10:41:00,10:43:00,10:45:00,,11:05:00,11:03:00,11:01:00,10:59:00,10:57:00,10:55:00,10:53:00,10:51:00,10:49:00,10:47:00,10:44:00,10:42:00,10:40:00,10:38:00,10:36:00,10:34:00,10:32:00,10:30:00
10:25:00,10:27:00,10:29:00,10:31:00,10:33:00,10:35:00,10:37:00,10:39:00,10:41:00,10:43:00,10:45:00,10:48:00,10:50:00,10:52:00,10:54:00,10:56:00,10:58:00,11:00:00,,11:20:00,11:18:00,11:16:00,11:14:00,11:12:00,11:10:00,11:08:00,11:06:00,11:04:00,11:02:00,10:59:00,10:57:00,10:55:00,10:53:00,10:51:00,10:49:00,10:47:00,10:45:00
10:40:00,10:42:00,10:44:00,10:46:00,10:48:00,10:50:00,10:52:00,10:54:00,10:56:00,10:58:00,11:00:00,11:03:00,11:05:00,11:07:00,11:09:00,11:11:00,11:13:00,11:15:00,,11:35:00,11:33:00,11:31:00,11:29:00,11:27:00,11:25:00,11:23:00,11:21:00,11:19:00,11:17:00,11:14:00,11:12:00,11:10:00,11:08:00,11:06:00,11:04:00,11:02:00,11:00:00
10:55:00,10:57:00,10:59:00,11:01:00,11:03:00,11:05:00,11:07:00,11:09:00,11:11:00,11:13:00,11:15:00,11:18:00,11:20:00,11:22:00,11:24:00,11:26:00,11:28:00,11:30:00,,11:50:00,11:48:00,11:46:00,11:44:00,11:42:00,11:40:00,11:38:00,11:36:00,11:34:00,11:32:00,11:29:00,11:27:00,11:25:00,11:23:00,11:21:00,11:19:00,11:17:00,11:15:00
11:10:00,11:12:00,11:14:00,11:16:00,11:18:00,11:20:00,11:22:00,11:24:00,11:26:00,11:28:00,11:30:00,11:33:00,11:35:00,11:37:00,11:39:00,11:41:00,11:43:00,11:45:00,,12:05:00,12:03:00,12:01:00,11:59:00,11:57:00,11:55:00,11:53:00,11:51:00,11:49:00,11:47:00,11:44:00,11:42:00,11:40:00,11:38:00,11:36:00,11:34:00,11:32:00,11:30:00
11:25:00,11:27:00,11:29:00,11:31:00,11:33:00,11:35:00,11:37:00,11:39:00,11:41:00,11:43:00,11:45:00,11:48:00,11:50:00,11:52:00,11:54:00,11:56:00,11:58:00,12:00:00,,12:20:00,12:18:00,12:16:00,12:14:00,12:12:00,12:10:00,12:08:00,12:06:00,12:04:00,12:02:00,11:59:00,11:57:00,11:55:00,11:53:00,11:51:00,11:49:00,11:47:00,11:45:00
11:40:00,11:42:00,11:44:00,11:46:00,11:48:00,11:50:00,11:52:00,11:54:00,11:56:00,11:58:00,12:00:00,12:03:00,12:05:00,12:07:00,12:09:00,12:11:00,12:13:00,12:15:00,,12:35:00,12:33:00,12:31:00,12:29:00,12:27:00,12:25:00,12:23:00,12:21:00,12:19:00,12:17:00,12:14:00,12:12:00,12:10:00,12:08:00,12:06:00,12:04:00,12:02:00,12:00:00
11:55:00,11:57:00,11:59:00,12:01:00,12:03:00,12:05:00,12:07:00,12:09:00,12:11:00,12:13:00,12:15:00,12:18:00,12:20:00,12:22:00,12:24:00,12:26:00,12:28:00,12:30:00,,12:50:00,12:48:00,12:46:00,12:44:00,12:42:00,12:40:00,12:38:00,12:36:00,12:34:00,12:32:00,12:29:00,12:27:00,12:25:00,12:23:00,12:21:00,12:19:00,12:17:00,12:15:00
12:10:00,12:12:00,12:14:00,12:16:00,12:18:00,12:20:00,12:22:00,12:24:00,12:26:00,12:28:00,12:30:00,12:33:00,12:35:00,12:37:00,12:39:00,12:41:00,12:43:00,12:45:00,,13:05:00,13:03:00,13:01:00,12:59:00,12:57:00,12:55:00,12:53:00,12:51:00,12:49:00,12:47:00,12:44:00,12:42:00,12:40:00,12:38:00,12:36:00,12:34:00,12:32:00,12:30:00
12:25:00,12:27:00,12:29:00,12:31:00,12:33:00,12:35:00,12:37:00,12:39:00,12:41:00,12:43:00,12:45:00,12:48:00,12:50:00,12:52:00,12:54:00,12:56:00,12:58:00,13:00:00,,13:20:00,13:18:00,13:16:00,13:14:00,13:12:00,13:10:00,13:08:00,13:06:00,13:04:00,13:02:00,12:59:00,12:57:00,12:55:00,12:53:00,12:51:00,12:49:00,12:47:00,12:45:00
12:40:00,12:42:00,12:44:00,12:46:00,12:48:00,12:50:00,12:52:00,12:54:00,12:56:00,12:58:00,13:00:00,13:03:00,13:05:00,13:07:00,13:09:00,13:11:00,13:13:00,13:15:00,,13:35:00,13:33:00,13:31:00,13:29:00,13:27:00,13:25:00,13:23:00,13:21:00,13:19:00,13:17:00,13:14:00,13:12:00,13:10:00,13:08:00,13:06:00,13:04:00,13:02:00,13:00:00
12:55:00,12:57:00,12:59:00,13:01:00,13:03:00,13:05:00,13:07:00,13:09:00,13:11:00,13:13:00,13:15:00,13:18:00,13:20:00,13:22:00,13:24:00,13:26:00,13:28:00,13:30:00,,13:50:00,13:48:00,13:46:00,13:44:00,13:42:00,13:40:00,13:38:00,13:36:00,13:34:00,13:32:00,13:29:00,13:27:00,13:25:00,13:23:00,13:21:00,13:19:00,13:17:00,13:15:00
13:10:00,13:12:00,13:14:00,13:16:00,13:18:00,13:20:00,13:22:00,13:24:00,13:26:00,13:28:00,13:30:00,13:33:00,13:35:00,13:37:00,13:39:00,13:41:00,13:43:00,13:45:00,,14:05:00,14:03:00,14:01:00,13:59:00,13:57:00,13:55:00,13:53:00,13:51:00,13:49:00,13:47:00,13:44:00,13:42:00,13:40:00,13:38:00,13:36:00,13:34:00,13:32:00,13:30:00
13:25:00,13:27:00,13:29:00,13:31:00,13:33:00,13:35:00,13:37:00,13:39:00,13:41:00,13:43:00,13:45:00,13:48:00,13:50:00,13:52:00,13:54:00,13:56:00,13:58:00,14:00:00,,14:20:00,14:18:00,14:16:00,14:14:00,14:12:00,14:10:00,14:08:00,14:06:00,14:04:00,14:02:00,13:59:00,13:57:00,13:55:00,13:53:00,13:51:00,13:49:00,13:47:00,13:45:00
13:40:00,13:42:00,13:44:00,13:46:00,13:48:00,13:50:00,13:52:00,13:54:00,13:56:00,13:58:00,14:00:00,14:03:00,14:05:00,14:07:00,14:09:00,14:11:00,14:13:00,14:15:00,,14:35:00,14:33:00,14:31:00,14:29:00,14:27:00,14:25:00,14:23:00,14:21:00,14:19:00,14:17:00,14:14:00,14:12:00,14:10:00,14:08:00,14:06:00,14:04:00,14:02:00,14:00:00
13:55:00,13:57:00,13:59:00,14:01:00,14:03:00,14:05:00,14:07:00,14:09:00,14:11:00,14:13:00,14:15:00,14:18:00,14:20:00,14:22:00,14:24:00,14:26:00,14:28:00,14:30:00,,14:50:00,14:48:00,14:46:00,14:44:00,14:42:00,14:40:00,14:38:00,14:36:00,14:34:00,14:32:00,14:29:00,14:27:00,14:25:00,14:23:00,14:21:00,14:19:00,14:17:00,14:15:00
14:10:00,14:12:00,14:14:00,14:16:00,14:18:00,14:20:00,14:22:00,14:24:00,14:26:00,14:28:00,14:30:00,14:33:00,14:35:00,14:37:00,14:39:00,14:41:00,14:43:00,14:45:00,,15:05:00,15:03:00,15:01:00,14:59:00,14:57:00,14:55:00,14:53:00,14:51:00,14:49:00,14:47:00,14:44:00,14:42:00,14:40:00,14:38:00,14:36:00,14:34:00,14:32:00,14:30:00
14:25:00,14:27:00,14:29:00,14:31:00,14:33:00,14:35:00,14:37:00,14:39:00,14:41:00,14:43:00,14:45:00,14:48:00,14:50:00,14:52:00,14:54:00,14:56:00,14:58:00,15:00:00,,15:20:00,15:18:00,15:16:00,15:14:00,15:12:00,15:10:00,15:08:00,15:06:00,15:04:00,15:02:00,14:59:00,14:57:00,14:55:00,14:53:00,14:51:00,14:49:00,14:47:00,14:45:00
14:40:00,14:42:00,14:44:00,14:46:00,14:48:00,14:50:00,14:52:00,14:54:00,14:56:00,14:58:00,15:00:00,15:03:00,15:05:00,15:07:00,15:09:00,15:11:00,15:13:00,15:15:00,,15:35:00,15:33:00,15:31:00,15:29:00,15:27:00,15:25:00,15:23:00,15:21:00,15:19:00,15:17:00,15:14:00,15:12:00,15:10:00,15:08:00,15:06:00,15:04:00,15:02:00,15:00:00
14:55:00,14:57:00,14:59:00,15:01:00,15:03:00,15:05:00,15:07:00,15:09:00,15:11:00,15:13:00,15:15:00,15:18:00,15:20:00,15:22:00,15:24:00,15:26:00,15:28:00,15:30:00,,15:50:00,15:48:00,15:46:00,15:44:00,15:42:00,15:40:00,15:38:00,15:36:00,15:34:00,15:32:00,15:29:00,15:27:00,15:25:00,15:23:00,15:21:00,15:19:00,15:17:00,15:15:00
15:10:00,15:12:00,15:14:00,15:16:00,15:18:00,15:20:00,15:22:00,15:24:00,15:26:00,15:28:00,15:30:00,15:33:00,15:35:00,15:37:00,15:39:00,15:41:00,15:43:00,15:45:00,,16:05:00,16:03:00,16:01:00,15:59:00,15:57:00,15:55:00,15:53:00,15:51:00,15:49:00,15:47:00,15:44:00,15:42:00,15:40:00,15:38:00,15:36:00,15:34:00,15:32:00,15:30:00
15:25:00,15:27:00,15:29:00,15:31:00,15:33:00,15:35:00,15:37:00,15:39:00,15:41:00,15:43:00,15:45:00,15:48:00,15:50:00,15:52:00,15:54:00,15:56:00,15:58:00,16:00:00,,16:20:00,16:18:00,16:16:00,16:14:00,16:12:00,16:10:00,16:08:00,16:06:00,16:04:00,16:02:00,15:59:00,15:57:00,15:55:00,15:53:00,15:51:00,15:49:00,15:47:00,15:45:00
15:40:00,15:42:00,15:44:00,15:46:00,15:48:00,15:50:00,15:52:00,15:54:00,15:56:00,15:58:00,16:00:00,16:03:00,16:05:00,16:07:00,16:09:00,16:11:00,16:13:00,16:15:00,,16:35:00,16:33:00,16:31:00,16:29:00,16:27:00,16:25:00,16:23:00,16:21:00,16:19:00,16:17:00,16:14:00,16:12:00,16:10:00,16:08:00,16:06:00,16:04:00,16:02:00,16:00:00
15:55:00,15:57:00,15:59:00,16:01:00,16:03:00,16:05:00,16:07:00,16:09:00,16:11:00,16:13:00,16:15:00,16:18:00,16:20:00,16:22:00,16:24:00,16:26:00,16:28:00,16:30:00,,16:50:00,16:48:00,16:46:00,16:44:00,16:42:00,16:40:00,16:38:00,16:36:00,16:34:00,16:32:00,16:29:00,16:27:00,16:25:00,16:23:00,16:21:00,16:19:00,16:17:00,16:15:00
16:10:00,16:12:00,16:14:00,16:16:00,16:18:00,16:20:00,16:22:00,16:24:00,16:26:00,16:28:00,16:30:00,16:33:00,16:35:00,16:37:00,16:39:00,16:41:00,16:43:00,16:45:00,,17:05:00,17:03:00,17:01:00,16:59:00,16:57:00,16:55:00,16:53:00,16:51:00,16:49:00,16:47:00,16:44:00,16:42:00,16:40:00,16:38:00,16:36:00,16:34:00,16:32:00,16:30:00
16:25:00,16:27:00,16:29:00,16:31:00,16:33:00,16:35:00,16:37:00,16:39:00,16:41:00,16:43:00,16:45:00,16:48:00,16:50:00,16:52:00,16:54:00,16:56:00,16:58:00,17:00:00,,17:20:00,17:18:00,17:16:00,17:14:00,17:12:00,17:10:00,17:08:00,17:06:00,17:04:00,17:02:00,16:59:00,16:57:00,16:55:00,16:53:00,16:51:00,16:49:00,16:47:00,16:45:00
16:40:00,16:42:00,16:44:00,16:46:00,16:48:00,16:50:00,16:52:00,16:54:00,16:56:00,16:58:00,17:00:00,17:03:00,17:05:00,17:07:00,17:09:00,17:11:00,17:13:00,17:15:00,,17:35:00,17:33:00,17:31:00,17:29:00,17:27:00,17:25:00,17:23:00,17:21:00,17:19:00,17:17:00,17:14:00,17:12:00,17:10:00,17:08:00,17:06:00,17:04:00,17:02:00,17:00:00
16:55:00,16:57:00,16:59:00,17:01:00,17:03:00,17:05:00,17:07:00,17:09:00,17:11:00,17:13:00,17:15:00,17:18:00,17:20:00,17:22:00,17:24:00,17:26:00,17:28:00,17:30:00,,17:50:00,17:48:00,17:46:00,17:44:00,17:42:00,17:40:00,17:38:00,17:36:00,17:34:00,17:32:00,17:29:00,17:27:00,17:25:00,17:23:00,17:21:00,17:19:00,17:17:00,17:15:00
17:10:00,17:12:00,17:14:00,17:16:00,17:18:00,17:20:00,17:22:00,17:24:00,17:26:00,17:28:00,17:30:00,17:33:00,17:35:00,17:37:00,17:39:00,17:41:00,17:43:00,17:45:00,,18:05:00,18:03:00,18:01:00,17:59:00,17:57:00,17:55:00,17:53:00,17:51:00,17:49:00,17:47:00,17:44:00,17:42:00,17:40:00,17:38:00,17:36:00,17:34:00,17:32:00,17:30:00
17:25:00,17:27:00,17:29:00,17:31:00,17:33:00,17:35:00,17:37:00,17:39:00,17:41:00,17:43:00,17:45:00,17:48:00,17:50:00,17:52:00,17:54:00,17:56:00,17:58:00,18:00:00,,18:20:00,18:18:00,18:16:00,18:14:00,18:12:00,18:10:00,18:08:00,18:06:00,18:04:00,18:02:00,17:59:00,17:57:00,17:55:00,17:53:00,17:51:00,17:49:00,17:47:00,17:45:00
17:40:00,17:42:00,17:44:00,17:46:00,17:48:00,17:50:00,17:52:00,17:54:00,17:56:00,17:58:00,18:00:00,18:03:00,18:05:00,18:07:00,18:09:00,18:11:00,18:13:00,18:15:00,,18:35:00,18:33:00,18:31:00,18:29:00,18:27:00,18:25:00,18:23:00,18:21:00,18:19:00,18:17:00,18:14:00,18:12:00,18:10:00,18:08:00,18:06:00,18:04:00,18:02:00,18:00:00
17:55:00,17:57:00,17:59:00,18:01:00,18:03:00,18:05:00,18:07:00,18:09:00,18:11:00,18:13:00,18:15:00,18:18:00,18:20:00,18:22:00,18:24:00,18:26:00,18:28:00,18:30:00,,18:50:00,18:48:00,18:46:00,18:44:00,18:42:00,18:40:00,18:38:00,18:36:00,18:34:00,18:32:00,18:29:00,18:27:00,18:25:00,18:23:00,18:21:00,18:19:00,18:17:00,18:15:00
18:10:00,18:12:00,18:14:00,18:16:00,18:18:00,18:20:00,18:22:00,18:24:00,18:26:00,18:28:00,18:30:00,18:33:00,18:35:00,18:37:00,18:39:00,18:41:00,18:43:00,18:45:00,,19:05:00,19:03:00,19:01:00,18:59:00,18:57:00,18:55:00,18:53:00,18:51:00,18:49:00,18:47:00,18:44:00,18:42:00,18:40:00,18:38:00,18:36:00,18:34:00,18:32:00,18:30:00
18:25:00,18:27:00,18:29:00,18:31:00,18:33:00,18:35:00,18:37:00,18:39:00,18:41:00,18:43:00,18:45:00,18:48:00,18:50:00,18:52:00,18:54:00,18:56:00,18:58:00,19:00:00,,19:20:00,19:18:00,19:16:00,19:14:00,19:12:00,19:10:00,19:08:00,19:06:00,19:04:00,19:02:00,18:59:00,18:57:00,18:55:00,18:53:00,18:51:00,18:49:00,18:47:00,18:45:00
18:40:00,18:42:00,18:44:00,18:46:00,18:48:00,18:50:00,18:52:00,18:54:00,18:56:00,18:58:00,19:00:00,19:03:00,19:05:00,19:07:00,19:09:00,19:11:00,19:13:00,19:15:00,,19:35:00,19:33:00,19:31:00,19:29:00,19:27:00,19:25:00,19:23:00,19:21:00,19:19:00,19:17:00,19:14:00,19:12:00,19:10:00,19:08:00,19:06:00,19:04:00,19:02:00,19:00:00
18:55:00,18:57:00,18:59:00,19:01:00,19:03:00,19:05:00,19:07:00,19:09:00,19:11:00,19:13:00,19:15:00,19:18:00,19:20:00,19:22:00,19:24:00,19:26:00,19:28:00,19:30:00,,19:50:00,19:48:00,19:46:00,19:44:00,19:42:00,19:40:00,19:38:00,19:36:00,19:34:00,19:32:00,19:29:00,19:27:00,19:25:00,19:23:00,19:21:00,19:19:00,19:17:00,19:15:00
19:10:00,19:12:00,19:14:00,19:16:00,19:18:00,19:20:00,19:22:00,19:24:00,19:26:00,19:28:00,19:30:00,19:33:00,19:35:00,19:37:00,19:39:00,19:41:00,19:43:00,19:45:00,,20:05:00,20:03:00,20:01:00,19:59:00,19:57:00,19:55:00,19:53:00,19:51:00,19:49:00,19:47:00,19:44:00,19:42:00,19:40:00,19:38:00,19:36:00,19:34:00,19:32:00,19:30:00
19:25:00,19:27:00,19:29:00,19:31:00,19:33:00,19:35:00,19:37:00,19:39:00,19:41:00,19:43:00,19:45:00,19:48:00,19:50:00,19:52:00,19:54:00,19:56:00,19:58:00,20:00:00,,20:20:00,20:18:00,20:16:00,20:14:00,20:12:00,20:10:00,20:08:00,20:06:00,20:04:00,20:02:00,19:59:00,19:57:00,19:55:00,19:53:00,19:51:00,19:49:00,19:47:00,19:45:00
19:40:00,19:42:00,19:44:00,19:46:00,19:48:00,19:50:00,19:52:00,19:54:00,19:56:00,19:58:00,20:00:00,20:03:00,20:05:00,20:07:00,20:09:00,20:11:00,20:13:00,20:15:00,,20:35:00,20:33:00,20:31:00,20:29:00,20:27:00,20:25:00,20:23:00,20:21:00,20:19:00,20:17:00,20:14:00,20:12:00,20:10:00,20:08:00,20:06:00,20:04:00,20:02:00,20:00:00
19:55:00,19:57:00,19:59:00,20:01:00,20:03:00,20:05:00,20:07:00,20:09:00,20:11:00,20:13:00,20:15:00,20:18:00,20:20:00,20:22:00,20:24:00,20:26:00,20:28:00,20:30:00,,20:50:00,20:48:00,20:46:00,20:44:00,20:42:00,20:40:00,20:38:00,20:36:00,20:34:00,20:32:00,20:29:00,20:27:00,20:25:00,20:23:00,20:21:00,20:19:00,20:17:00,20:15:00
20:10:00,20:12:00,20:14:00,20:16:00,20:18:00,20:20:00,20:22:00,20:24:00,20:26:00,20:28:00,20:30:00,20:33:00,20:35:00,20:37:00,20:39:00,20:41:00,20:43:00,20:45:00,,21:05:00,21:03:00,21:01:00,20:59:00,20:57:00,20:55:00,20:53:00,20:51:00,20:49:00,20:47:00,20:44:00,20:42:00,20:40:00,20:38:00,20:36:00,20:34:00,20:32:00,20:30:00
`;

// داده‌های فایل: MetroTimeSheet.xlsx - تعطیلات.csv
const csvDataHoliday = `
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
حرکت از ایستگاه به سمت ایستگاه نور,,,,,,,,,,,,,,,,,,,حرکت از ایستگاه به سمت ایستگاه ائل گؤلی,,,,,,,,,,,,,,,,
 ائل گؤلی, سهند, امام رضا(ع), خیام,29بهمن, استاد شهریار, دانشگاه, آبرسان, سالار ملی(قطب), شهید بهشتی (ره), میدان ساعت, میدان کهن, قونقا, گازران, لاله, امام حسین(ع), شهید باکری, نور,***, ائل گؤلی, سهند, امام رضا(ع), خیام,29بهمن, استاد شهریار, دانشگاه, آبرسان, سالار ملی(قطب), شهید بهشتی (ره), میدان ساعت, میدان کهن, قونقا, گازران, لاله, امام حسین(ع), شهید باکری, نور
07:30:00,07:32:00,07:34:00,07:36:00,07:38:00,07:40:00,07:42:00,07:44:00,07:46:00,07:48:00,07:50:00,07:53:00,07:55:00,07:57:00,07:59:00,08:01:00,08:03:00,08:05:00,***,08:15:00,08:13:00,08:11:00,08:09:00,08:07:00,08:05:00,08:03:00,08:01:00,07:59:00,07:57:00,07:54:00,07:52:00,07:50:00,07:48:00,07:46:00,07:44:00,07:42:00,07:40:00
07:46:00,07:48:00,07:50:00,07:52:00,07:54:00,07:56:00,07:58:00,08:00:00,08:02:00,08:04:00,08:06:00,08:09:00,08:11:00,08:13:00,08:15:00,08:17:00,08:19:00,08:21:00,***,08:31:00,08:29:00,08:27:00,08:25:00,08:23:00,08:21:00,08:19:00,08:17:00,08:15:00,08:13:00,08:10:00,08:08:00,08:06:00,08:04:00,08:02:00,08:00:00,07:58:00,07:56:00
08:02:00,08:04:00,08:06:00,08:08:00,08:10:00,08:12:00,08:14:00,08:16:00,08:18:00,08:20:00,08:22:00,08:25:00,08:27:00,08:29:00,08:31:00,08:33:00,08:35:00,08:37:00,***,08:47:00,08:45:00,08:43:00,08:41:00,08:39:00,08:37:00,08:35:00,08:33:00,08:31:00,08:29:00,08:26:00,08:24:00,08:22:00,08:20:00,08:18:00,08:16:00,08:14:00,08:12:00
08:18:00,08:20:00,08:22:00,08:24:00,08:26:00,08:28:00,08:30:00,08:32:00,08:34:00,08:36:00,08:38:00,08:41:00,08:43:00,08:45:00,08:47:00,08:49:00,08:51:00,08:53:00,***,09:03:00,09:01:00,08:59:00,08:57:00,08:55:00,08:53:00,08:51:00,08:49:00,08:47:00,08:45:00,08:42:00,08:40:00,08:38:00,08:36:00,08:34:00,08:32:00,08:30:00,08:28:00
08:34:00,08:36:00,08:38:00,08:40:00,08:42:00,08:44:00,08:46:00,08:48:00,08:50:00,08:52:00,08:54:00,08:57:00,08:59:00,09:01:00,09:03:00,09:05:00,09:07:00,09:09:00,***,09:19:00,09:17:00,09:15:00,09:13:00,09:11:00,09:09:00,09:07:00,09:05:00,09:03:00,09:01:00,08:58:00,08:56:00,08:54:00,08:52:00,08:50:00,08:48:00,08:46:00,08:44:00
08:50:00,08:52:00,08:54:00,08:56:00,08:58:00,09:00:00,09:02:00,09:04:00,09:06:00,09:08:00,09:10:00,09:13:00,09:15:00,09:17:00,09:19:00,09:21:00,09:23:00,09:25:00,***,09:35:00,09:33:00,09:31:00,09:29:00,09:27:00,09:25:00,09:23:00,09:21:00,09:19:00,09:17:00,09:14:00,09:12:00,09:10:00,09:08:00,09:06:00,09:04:00,09:02:00,09:00:00
09:06:00,09:08:00,09:10:00,09:12:00,09:14:00,09:16:00,09:18:00,09:20:00,09:22:00,09:24:00,09:26:00,09:29:00,09:31:00,09:33:00,09:35:00,09:37:00,09:39:00,09:41:00,***,09:51:00,09:49:00,09:47:00,09:45:00,09:43:00,09:41:00,09:39:00,09:37:00,09:35:00,09:33:00,09:30:00,09:28:00,09:26:00,09:24:00,09:22:00,09:20:00,09:18:00,09:16:00
09:22:00,09:24:00,09:26:00,09:28:00,09:30:00,09:32:00,09:34:00,09:36:00,09:38:00,09:40:00,09:42:00,09:45:00,09:47:00,09:49:00,09:51:00,09:53:00,09:55:00,09:57:00,***,10:07:00,10:05:00,10:03:00,10:01:00,09:59:00,09:57:00,09:55:00,09:53:00,09:51:00,09:49:00,09:46:00,09:44:00,09:42:00,09:40:00,09:38:00,09:36:00,09:34:00,09:32:00
09:38:00,09:40:00,09:42:00,09:44:00,09:46:00,09:48:00,09:50:00,09:52:00,09:54:00,09:56:00,09:58:00,10:01:00,10:03:00,10:05:00,10:07:00,10:09:00,10:11:00,10:13:00,***,10:23:00,10:21:00,10:19:00,10:17:00,10:15:00,10:13:00,10:11:00,10:09:00,10:07:00,10:05:00,10:02:00,10:00:00,09:58:00,09:56:00,09:54:00,09:52:00,09:50:00,09:48:00
09:54:00,09:56:00,09:58:00,10:00:00,10:02:00,10:04:00,10:06:00,10:08:00,10:10:00,10:12:00,10:14:00,10:17:00,10:19:00,10:21:00,10:23:00,10:25:00,10:27:00,10:29:00,***,10:39:00,10:37:00,10:35:00,10:33:00,10:31:00,10:29:00,10:27:00,10:25:00,10:23:00,10:21:00,10:18:00,10:16:00,10:14:00,10:12:00,10:10:00,10:08:00,10:06:00,10:04:00
10:10:00,10:12:00,10:14:00,10:16:00,10:18:00,10:20:00,10:22:00,10:24:00,10:26:00,10:28:00,10:30:00,10:33:00,10:35:00,10:37:00,10:39:00,10:41:00,10:43:00,10:45:00,***,10:55:00,10:53:00,10:51:00,10:49:00,10:47:00,10:45:00,10:43:00,10:41:00,10:39:00,10:37:00,10:34:00,10:32:00,10:30:00,10:28:00,10:26:00,10:24:00,10:22:00,10:20:00
10:26:00,10:28:00,10:30:00,10:32:00,10:34:00,10:36:00,10:38:00,10:40:00,10:42:00,10:44:00,10:46:00,10:49:00,10:51:00,10:53:00,10:55:00,10:57:00,10:59:00,11:01:00,***,11:11:00,11:09:00,11:07:00,11:05:00,11:03:00,11:01:00,10:59:00,10:57:00,10:55:00,10:53:00,10:50:00,10:48:00,10:46:00,10:44:00,10:42:00,10:40:00,10:38:00,10:36:00
10:42:00,10:44:00,10:46:00,10:48:00,10:50:00,10:52:00,10:54:00,10:56:00,10:58:00,11:00:00,11:02:00,11:05:00,11:07:00,11:09:00,11:11:00,11:13:00,11:15:00,11:17:00,***,11:27:00,11:25:00,11:23:00,11:21:00,11:19:00,11:17:00,11:15:00,11:13:00,11:11:00,11:09:00,11:06:00,11:04:00,11:02:00,11:00:00,10:58:00,10:56:00,10:54:00,10:52:00
10:58:00,11:00:00,11:02:00,11:04:00,11:06:00,11:08:00,11:10:00,11:12:00,11:14:00,11:16:00,11:18:00,11:21:00,11:23:00,11:25:00,11:27:00,11:29:00,11:31:00,11:33:00,***,11:43:00,11:41:00,11:39:00,11:37:00,11:35:00,11:33:00,11:31:00,11:29:00,11:27:00,11:25:00,11:22:00,11:20:00,11:18:00,11:16:00,11:14:00,11:12:00,11:10:00,11:08:00
11:14:00,11:16:00,11:18:00,11:20:00,11:22:00,11:24:00,11:26:00,11:28:00,11:30:00,11:32:00,11:34:00,11:37:00,11:39:00,11:41:00,11:43:00,11:45:00,11:47:00,11:49:00,***,11:59:00,11:57:00,11:55:00,11:53:00,11:51:00,11:49:00,11:47:00,11:45:00,11:43:00,11:41:00,11:38:00,11:36:00,11:34:00,11:32:00,11:30:00,11:28:00,11:26:00,11:24:00
11:30:00,11:32:00,11:34:00,11:36:00,11:38:00,11:40:00,11:42:00,11:44:00,11:46:00,11:48:00,11:50:00,11:53:00,11:55:00,11:57:00,11:59:00,12:01:00,12:03:00,12:05:00,***,12:15:00,12:13:00,12:11:00,12:09:00,12:07:00,12:05:00,12:03:00,12:01:00,11:59:00,11:57:00,11:54:00,11:52:00,11:50:00,11:48:00,11:46:00,11:44:00,11:42:00,11:40:00
11:46:00,11:48:00,11:50:00,11:52:00,11:54:00,11:56:00,11:58:00,12:00:00,12:02:00,12:04:00,12:06:00,12:09:00,12:11:00,12:13:00,12:15:00,12:17:00,12:19:00,12:21:00,***,12:31:00,12:29:00,12:27:00,12:25:00,12:23:00,12:21:00,12:19:00,12:17:00,12:15:00,12:13:00,12:10:00,12:08:00,12:06:00,12:04:00,12:02:00,12:00:00,11:58:00,11:56:00
12:02:00,12:04:00,12:06:00,12:08:00,12:10:00,12:12:00,12:14:00,12:16:00,12:18:00,12:20:00,12:22:00,12:25:00,12:27:00,12:29:00,12:31:00,12:33:00,12:35:00,12:37:00,***,12:47:00,12:45:00,12:43:00,12:41:00,12:39:00,12:37:00,12:35:00,12:33:00,12:31:00,12:29:00,12:26:00,12:24:00,12:22:00,12:20:00,12:18:00,12:16:00,12:14:00,12:12:00
12:18:00,12:20:00,12:22:00,12:24:00,12:26:00,12:28:00,12:30:00,12:32:00,12:34:00,12:36:00,12:38:00,12:41:00,12:43:00,12:45:00,12:47:00,12:49:00,12:51:00,12:53:00,***,13:03:00,13:01:00,12:59:00,12:57:00,12:55:00,12:53:00,12:51:00,12:49:00,12:47:00,12:45:00,12:42:00,12:40:00,12:38:00,12:36:00,12:34:00,12:32:00,12:30:00,12:28:00
12:34:00,12:36:00,12:38:00,12:40:00,12:42:00,12:44:00,12:46:00,12:48:00,12:50:00,12:52:00,12:54:00,12:57:00,12:59:00,13:01:00,13:03:00,13:05:00,13:07:00,13:09:00,***,13:19:00,13:17:00,13:15:00,13:13:00,13:11:00,13:09:00,13:07:00,13:05:00,13:03:00,13:01:00,12:58:00,12:56:00,12:54:00,12:52:00,12:50:00,12:48:00,12:46:00,12:44:00
12:50:00,12:52:00,12:54:00,12:56:00,12:58:00,13:00:00,13:02:00,13:04:00,13:06:00,13:08:00,13:10:00,13:13:00,13:15:00,13:17:00,13:19:00,13:21:00,13:23:00,13:25:00,***,13:35:00,13:33:00,13:31:00,13:29:00,13:27:00,13:25:00,13:23:00,13:21:00,13:19:00,13:17:00,13:14:00,13:12:00,13:10:00,13:08:00,13:06:00,13:04:00,13:02:00,13:00:00
13:06:00,13:08:00,13:10:00,13:12:00,13:14:00,13:16:00,13:18:00,13:20:00,13:22:00,13:24:00,13:26:00,13:29:00,13:31:00,13:33:00,13:35:00,13:37:00,13:39:00,13:41:00,***,13:51:00,13:49:00,13:47:00,13:45:00,13:43:00,13:41:00,13:39:00,13:37:00,13:35:00,13:33:00,13:30:00,13:28:00,13:26:00,13:24:00,13:22:00,13:20:00,13:18:00,13:16:00
13:22:00,13:24:00,13:26:00,13:28:00,13:30:00,13:32:00,13:34:00,13:36:00,13:38:00,13:40:00,13:42:00,13:45:00,13:47:00,13:49:00,13:51:00,13:53:00,13:55:00,13:57:00,***,14:07:00,14:05:00,14:03:00,14:01:00,13:59:00,13:57:00,13:55:00,13:53:00,13:51:00,13:49:00,13:46:00,13:44:00,13:42:00,13:40:00,13:38:00,13:36:00,13:34:00,13:32:00
13:38:00,13:40:00,13:42:00,13:44:00,13:46:00,13:48:00,13:50:00,13:52:00,1D:54:00,13:56:00,13:58:00,14:01:00,14:03:00,14:05:00,14:07:00,14:09:00,14:11:00,14:13:00,***,14:23:00,14:21:00,14:19:00,14:17:00,14:15:00,14:13:00,14:11:00,14:09:00,14:07:00,14:05:00,14:02:00,14:00:00,13:58:00,13:56:00,13:54:00,13:52:00,13:50:00,13:48:00
13:54:00,13:56:00,13:58:00,14:00:00,14:02:00,14:04:00,14:06:00,14:08:00,14:10:00,14:12:00,14:14:00,14:17:00,14:19:00,14:21:00,14:23:00,14:25:00,14:27:00,14:29:00,***,14:39:00,14:37:00,14:35:00,14:33:00,14:31:00,14:29:00,14:27:00,14:25:00,14:23:00,14:21:00,14:18:00,14:16:00,14:14:00,14:12:00,14:10:00,14:08:00,14:06:00,14:04:00
14:10:00,14:12:00,14:14:00,14:16:00,14:18:00,14:20:00,14:22:00,14:24:00,14:26:00,14:28:00,14:30:00,14:33:00,14:35:00,14:37:00,14:39:00,14:41:00,14:43:00,14:45:00,***,14:55:00,14:53:00,14:51:00,14:49:00,14:47:00,14:45:00,14:43:00,14:41:00,14:39:00,14:37:00,14:34:00,14:32:00,14:30:00,14:28:00,14:26:00,14:24:00,14:22:00,14:20:00
14:26:00,14:28:00,14:30:00,14:32:00,14:34:00,14:36:00,14:38:00,14:40:00,14:42:00,14:44:00,14:46:00,14:49:00,14:51:00,14:53:00,14:55:00,14:57:00,14:59:00,15:01:00,***,15:11:00,15:09:00,15:07:00,15:05:00,15:03:00,15:01:00,14:59:00,14:57:00,14:55:00,14:53:00,14:50:00,14:48:00,14:46:00,14:44:00,14:42:00,14:40:00,14:38:00,14:36:00
14:42:00,14:44:00,14:46:00,14:48:00,14:50:00,14:52:00,14:54:00,14:56:00,14:58:00,15:00:00,15:02:00,15:05:00,15:07:00,15:09:00,15:11:00,15:13:00,15:15:00,15:17:00,***,15:27:00,15:25:00,15:23:00,15:21:00,15:19:00,15:17:00,15:15:00,15:13:00,15:11:00,15:09:00,15:06:00,15:04:00,15:02:00,15:00:00,14:58:00,14:56:00,14:54:00,14:52:00
14:58:00,15:00:00,15:02:00,15:04:00,15:06:00,15:08:00,15:10:00,15:12:00,15:14:00,15:16:00,15:18:00,15:21:00,15:23:00,15:25:00,15:27:00,15:29:00,15:31:00,15:33:00,***,15:43:00,15:41:00,15:39:00,15:37:00,15:35:00,15:33:00,15:31:00,15:29:00,15:27:00,15:25:00,15:22:00,15:20:00,15:18:00,15:16:00,15:14:00,15:12:00,15:10:00,15:08:00
15:14:00,15:16:00,15:18:00,15:20:00,15:22:00,15:24:00,15:26:00,15:28:00,15:30:00,15:32:00,15:34:00,15:37:00,15:39:00,15:41:00,15:43:00,15:45:00,15:47:00,15:49:00,***,15:59:00,15:57:00,15:55:00,15:53:00,15:51:00,15:49:00,15:47:00,15:45:00,15:43:00,15:41:00,15:38:00,15:36:00,15:34:00,15:32:00,15:30:00,15:28:00,15:26:00,15:24:00
15:30:00,15:32:00,15:34:00,15:36:00,15:38:00,15:40:00,15:42:00,15:44:00,15:46:00,15:48:00,15:50:00,15:53:00,15:55:00,15:57:00,15:59:00,16:01:00,16:03:00,16:05:00,***,16:15:00,16:13:00,16:11:00,16:09:00,16:07:00,16:05:00,16:03:00,16:01:00,15:59:00,15:57:00,15:54:00,15:52:00,15:50:00,15:48:00,15:46:00,15:44:00,15:42:00,15:40:00
15:46:00,15:48:00,15:50:00,15:52:00,15:54:00,15:56:00,15:58:00,16:00:00,16:02:00,16:04:00,16:06:00,16:09:00,16:11:00,16:13:00,16:15:00,16:17:00,16:19:00,16:21:00,***,16:31:00,16:29:00,16:27:00,16:25:00,16:23:00,16:21:00,16:19:00,16:17:00,16:15:00,16:13:00,16:10:00,16:08:00,16:06:00,16:04:00,16:02:00,16:00:00,15:58:00,15:56:00
16:02:00,16:04:00,16:06:00,16:08:00,16:10:00,16:12:00,16:14:00,16:16:00,16:18:00,16:20:00,16:22:00,16:25:00,16:27:00,16:29:00,16:31:00,16:33:00,16:35:00,16:37:00,***,16:47:00,16:45:00,16:43:00,16:41:00,16:39:00,16:37:00,16:35:00,16:33:00,16:31:00,16:29:00,16:26:00,16:24:00,16:22:00,16:20:00,16:18:00,16:16:00,16:14:00,16:12:00
16:18:00,16:20:00,16:22:00,16:24:00,16:26:00,16:28:00,16:30:00,16:32:00,16:34:00,16:36:00,16:38:00,16:41:00,16:43:00,16:45:00,16:47:00,16:49:00,16:51:00,16:53:00,***,17:03:00,17:01:00,16:59:00,16:57:00,16:55:00,16:53:00,16:51:00,16:49:00,16:47:00,16:45:00,16:42:00,16:40:00,16:38:00,16:36:00,16:34:00,16:32:00,16:30:00,16:28:00
16:34:00,16:36:00,16:38:00,16:40:00,16:42:00,16:44:00,16:46:00,16:48:00,16:50:00,16:52:00,16:54:00,16:57:00,16:59:00,17:01:00,17:03:00,17:05:00,17:07:00,17:09:00,***,17:19:00,17:17:00,17:15:00,17:13:00,17:11:00,17:09:00,17:07:00,17:05:00,17:03:00,17:01:00,16:58:00,16:56:00,16:54:00,16:52:00,16:50:00,16:48:00,16:46:00,16:44:00
16:50:00,16:52:00,16:54:00,16:56:00,16:58:00,17:00:00,17:02:00,17:04:00,17:06:00,17:08:00,17:10:00,17:13:00,17:15:00,17:17:00,17:19:00,17:21:00,17:23:00,17:25:00,***,17:35:00,17:33:00,17:31:00,17:29:00,17:27:00,17:25:00,17:23:00,17:21:00,17:19:00,17:17:00,17:14:00,17:12:00,17:10:00,17:08:00,17:06:00,17:04:00,17:02:00,17:00:00
17:06:00,17:08:00,17:10:00,17:12:00,17:14:00,17:16:00,17:18:00,17:20:00,17:22:00,17:24:00,17:26:00,17:29:00,17:31:00,17:33:00,17:35:00,17:37:00,17:39:00,17:41:00,***,17:51:00,17:49:00,17:47:00,17:45:00,17:43:00,17:41:00,17:39:00,17:37:00,17:35:00,17:33:00,17:30:00,17:28:00,17:26:00,17:24:00,17:22:00,17:20:00,17:18:00,17:16:00
17:22:00,17:24:00,17:26:00,17:28:00,17:30:00,17:32:00,17:34:00,17:36:00,17:38:00,17:40:00,17:42:00,17:45:00,17:47:00,17:49:00,17:51:00,17:53:00,17:55:00,17:57:00,***,18:07:00,18:05:00,18:03:00,18:01:00,17:59:00,17:57:00,17:55:00,17:53:00,17:51:00,17:49:00,17:46:00,17:44:00,17:42:00,17:40:00,17:38:00,17:36:00,17:34:00,17:32:00
17:38:00,17:40:00,17:42:00,17:44:00,17:46:00,17:48:00,17:50:00,17:52:00,17:54:00,17:56:00,17:58:00,18:01:00,18:03:00,18:05:00,18:07:00,18:09:00,18:11:00,18:13:00,***,18:23:00,18:21:00,18:19:00,18:17:00,18:15:00,18:13:00,18:11:00,18:09:00,18:07:00,18:05:00,18:02:00,18:00:00,17:58:00,17:56:00,17:54:00,17:52:00,17:50:00,17:48:00
17:54:00,17:56:00,17:58:00,18:00:00,18:02:00,18:04:00,18:06:00,18:08:00,18:10:00,18:12:00,18:14:00,18:17:00,18:19:00,18:21:00,18:23:00,18:25:00,18:27:00,18:29:00,***,18:39:00,18:37:00,18:35:00,18:33:00,18:31:00,18:29:00,18:27:00,18:25:00,18:23:00,18:21:00,18:18:00,18:16:00,18:14:00,18:12:00,18:10:00,18:08:00,18:06:00,18:04:00
18:10:00,18:12:00,18:14:00,18:16:00,18:18:00,18:20:00,18:22:00,18:24:00,18:26:00,18:28:00,18:30:00,18:33:00,18:35:00,18:37:00,18:39:00,18:41:00,18:43:00,18:45:00,***,18:55:00,18:53:00,18:51:00,18:49:00,18:47:00,18:45:00,18:43:00,18:41:00,18:39:00,18:37:00,18:34:00,18:32:00,18:30:00,18:28:00,18:26:00,18:24:00,18:22:00,18:20:00
18:26:00,18:28:00,18:30:00,18:32:00,18:34:00,18:36:00,18:38:00,18:40:00,18:42:00,18:44:00,18:46:00,18:49:00,18:51:00,18:53:00,18:55:00,18:57:00,18:59:00,19:01:00,***,19:11:00,19:09:00,19:07:00,19:05:00,19:03:00,19:01:00,18:59:00,18:57:00,18:55:00,18:53:00,18:50:00,18:48:00,18:46:00,18:44:00,18:42:00,18:40:00,18:38:00,18:36:00
18:42:00,18:44:00,18:46:00,18:48:00,18:50:00,18:52:00,18:54:00,18:56:00,18:58:00,19:00:00,19:02:00,19:05:00,19:07:00,19:09:00,19:11:00,19:13:00,19:15:00,19:17:00,***,19:27:00,19:25:00,19:23:00,19:21:00,19:19:00,19:17:00,19:15:00,19:13:00,19:11:00,19:09:00,19:06:00,19:04:00,19:02:00,19:00:00,18:58:00,18:56:00,18:54:00,18:52:00
18:58:00,19:00:00,19:02:00,19:04:00,19:06:00,19:08:00,19:10:00,19:12:00,19:14:00,19:16:00,19:18:00,19:21:00,19:23:00,19:25:00,19:27:00,19:29:00,19:31:00,19:33:00,***,19:43:00,19:41:00,19:39:00,19:37:00,19:35:00,19:33:00,19:31:00,19:29:00,19:27:00,19:25:00,19:22:00,19:20:00,19:18:00,19:16:00,19:14:00,19:12:00,19:10:00,19:08:00
19:14:00,19:16:00,19:18:00,19:20:00,19:22:00,19:24:00,19:26:00,19:28:00,19:30:00,19:32:00,19:34:00,19:37:00,19:39:00,19:41:00,19:43:00,19:45:00,19:47:00,19:49:00,***,19:59:00,19:57:00,19:55:00,19:53:00,19:51:00,19:49:00,19:47:00,19:45:00,19:43:00,19:41:00,19:38:00,19:36:00,19:34:00,19:32:00,19:30:00,19:28:00,19:26:00,19:24:00
19:30:00,19:32:00,19:34:00,19:36:00,19:38:00,19:40:00,19:42:00,19:44:00,19:46:00,19:48:00,19:50:00,19:53:00,19:55:00,19:57:00,19:59:00,20:01:00,20:03:00,20:05:00,***,20:15:00,20:13:00,20:11:00,20:09:00,20:07:00,20:05:00,20:03:00,20:01:00,19:59:00,19:57:00,19:54:00,19:52:00,19:50:00,19:48:00,19:46:00,19:44:00,19:42:00,19:40:00
19:46:00,19:48:00,19:50:00,19:52:00,19:54:00,19:56:00,19:58:00,20:00:00,20:02:00,20:04:00,20:06:00,20:09:00,20:11:00,20:13:00,20:15:00,20:17:00,20:19:00,20:21:00,***,20:31:00,20:29:00,20:27:00,20:25:00,20:23:00,20:21:00,20:19:00,20:17:00,20:15:00,20:13:00,20:10:00,20:08:00,20:06:00,20:04:00,20:02:00,20:00:00,19:58:00,19:56:00
20:02:00,20:04:00,20:06:00,20:08:00,20:10:00,20:12:00,20:14:00,20:16:00,20:18:00,20:20:00,20:22:00,20:25:00,20:27:00,20:29:00,20:31:00,20:33:00,20:35:00,20:37:00,***,20:47:00,20:45:00,20:43:00,20:41:00,20:39:00,20:37:00,20:35:00,20:33:00,20:31:00,20:29:00,20:26:00,20:24:00,20:22:00,20:20:00,20:18:00,20:16:00,20:14:00,20:12:00
20:18:00,20:20:00,20:22:00,20:24:00,20:26:00,20:28:00,20:30:00,20:32:00,20:34:00,20:36:00,20:38:00,20:41:00,20:43:00,20:45:00,20:47:00,20:49:00,20:51:00,20:53:00,***,21:03:00,21:01:00,20:59:00,20:57:00,20:55:00,20:53:00,20:51:00,20:49:00,20:47:00,20:45:00,20:42:00,20:40:00,20:38:00,20:36:00,20:34:00,20:32:00,20:30:00,20:28:00
`;

// =====================================================================
// ||                    ساعت زنده (Live Clock)                       ||
// =====================================================================
const liveClock = {
    clockElement: document.getElementById('live-clock'),
    intervalId: null,

    init() {
        this.updateTime(); // Update immediately on init
        this.intervalId = setInterval(() => this.updateTime(), 1000);
    },

    updateTime() {
        if (this.clockElement) {
            const now = new Date();
            // Format to HH:MM:SS with padding
            const timeString = [
                now.getHours(),
                now.getMinutes(),
                now.getSeconds()
            ].map(num => String(num).padStart(2, '0')).join(':');

            this.clockElement.textContent = timeString;
        }
    }
};

// =====================================================================
// ||                تقویم شمسی (Persian Calendar)                   ||
// =====================================================================
const persianCalendar = {
    dateElement: document.getElementById('persian-date'),

    init() {
        this.updateDate();
        // Update daily (in milliseconds: 24h * 60m * 60s * 1000ms)
        setInterval(() => this.updateDate(), 24 * 60 * 60 * 1000);
    },

    updateDate() {
        if (this.dateElement) {
            try {
                const options = {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                };
                // Use built-in browser Intl API for Persian date
                const persianDate = new Date().toLocaleDateString('fa-IR', options);
                this.dateElement.textContent = persianDate;
            } catch (error) {
                console.error("Error formatting Persian date:", error);
                this.dateElement.textContent = "خطا در نمایش تاریخ";
            }
        }
    }
};

// =====================================================================
// ||               مدیریت داده‌های مترو (Local)                     ||
// =====================================================================
const metroDataManager = {
    metroData: {
        normal: null,
        holiday: null
    },
    stationNames: [], // Unique list of stations

    /**
     * Parses the embedded CSV string into a structured object
     * @param {string} csvString The raw CSV data
     * @returns {object} Parsed metro data structure
     */
    parseCsvData(csvString) {
        const lines = csvString.trim().split('\n');

        // Find the header row (index 2)
        const headerLine = lines[2].split(',');
        const separatorIndex = headerLine.indexOf('***');

        if (separatorIndex === -1) {
            console.error("CSV separator '***' not found.");
            return null;
        }

        // Get station names from the first block
        const stations = headerLine.slice(0, separatorIndex).map(s => s.trim());

        // Get direction titles from the row above headers (index 1)
        const titleLine = lines[1].split(',');
        const direction1_header = titleLine[0].trim();
        const direction2_header = titleLine[separatorIndex + 1].trim();

        const timetable = [];

        // Process data rows (starting from index 3)
        for (let i = 3; i < lines.length; i++) {
            if (!lines[i] || lines[i].trim().length === 0) continue;

            const columns = lines[i].split(',');

            const dir1_times = columns.slice(0, separatorIndex).map(t => t.trim() || null);
            const dir2_times = columns.slice(separatorIndex + 1).map(t => t.trim() || null);

            // Only add if there's valid time data in the row
            if (dir1_times.some(t => t) || dir2_times.some(t => t)) {
                timetable.push({ dir1_times, dir2_times });
            }
        }

        return {
            stations,
            direction1_header,
            direction2_header,
            timetable
        };
    },

    /**
     * Initializes the data manager by parsing the embedded CSV strings
     */
    init() {
        try {
            this.metroData.normal = this.parseCsvData(csvDataNormal);
            this.metroData.holiday = this.parseCsvData(csvDataHoliday);

            if (this.metroData.normal && this.metroData.normal.stations) {
                this.stationNames = this.metroData.normal.stations;
            } else {
                console.error("Failed to parse normal day data.");
                this.stationNames = [];
            }
        } catch (error) {
            console.error("Error initializing metro data:", error);
        }
        // No async needed, just return a promise-like "then"
        return {
            then: (callback) => callback()
        };
    }
};

// =====================================================================
// ||                     هسته برنامه (Metro App)                       ||
// =====================================================================
const metroApp = {
    // DOM Elements
    stationSelect: document.getElementById('station-select'),
    dayTypeSelect: document.getElementById('day-type-select'),
    scheduleContainer: document.getElementById('schedule-container'),
    loadingSpinner: document.getElementById('loading'),
    initialMessage: document.getElementById('initial-message'),

    // NEW: Summary Card DOM Elements (Updated with countdown)
    summaryContainer: document.getElementById('summary-container'),
    summaryDir1: {
        title: document.getElementById('summary-dir-1-title'),
        nextTime: document.getElementById('summary-dir-1-next-time'),
        secondTime: document.getElementById('summary-dir-1-second-time'),
        countdown: document.getElementById('summary-dir-1-countdown'),
        secondCountdown: document.getElementById('summary-dir-1-second-countdown'),
    },
    summaryDir2: {
        title: document.getElementById('summary-dir-2-title'),
        nextTime: document.getElementById('summary-dir-2-next-time'),
        secondTime: document.getElementById('summary-dir-2-second-time'),
        countdown: document.getElementById('summary-dir-2-countdown'),
        secondCountdown: document.getElementById('summary-dir-2-second-countdown'),
    },
    /**
 * NEW: Calculates minutes remaining until a train time
 * @param {string} trainTime - Train time in "HH:MM:SS" format
 * @returns {number} Minutes remaining (rounded up)
 */
    calculateMinutesRemaining(trainTime) {
        const now = new Date();
        const [hours, minutes] = trainTime.split(':').map(Number);

        const trainDate = new Date();
        trainDate.setHours(hours, minutes, 0, 0);

        const diffMs = trainDate - now;
        const diffMinutes = Math.ceil(diffMs / (1000 * 60));

        return Math.max(0, diffMinutes); // Return 0 if train has already passed
    },


    // State
    currentTime: null,
    updateInterval: null,

    /**
     * Initializes the main application
     * @param {string[]} stationNames - List of station names from data manager
     */
    init(stationNames) {
        if (!this.stationSelect || !this.dayTypeSelect || !this.scheduleContainer) {
            console.error('Core app elements not found. Aborting.');
            return;
        }

        // Populate station dropdown
        if (stationNames && stationNames.length > 0) {
            this.stationSelect.innerHTML = '<option value="">-- انتخاب ایستگاه --</option>';
            stationNames.forEach(name => {
                if (name && name !== '***') {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    this.stationSelect.appendChild(option);
                }
            });
        } else {
            this.showError('لیست ایستگاه‌ها بارگذاری نشد.');
        }

        // Add event listeners
        this.stationSelect.addEventListener('change', () => this.updateSchedule());
        this.dayTypeSelect.addEventListener('change', () => this.updateSchedule());

        // Start the continuous update loop (every 10 seconds)
        this.updateInterval = setInterval(() => {
            if (this.stationSelect.value) { // Only update if a station is selected
                this.updateSchedule();
            }
        }, 10000); // Update every 10 seconds
    },

    /**
     * Main function to update the schedule display
     */
    updateSchedule() {
        const selectedStation = this.stationSelect.value;
        const selectedDayType = this.dayTypeSelect.value;

        // Hide initial message
        if (this.initialMessage) {
            this.initialMessage.classList.add('hidden');
        }

        // If no station is selected, clear the schedule
        if (!selectedStation) {
            this.scheduleContainer.innerHTML = '';
            if (this.initialMessage) {
                this.initialMessage.classList.remove('hidden');
            }
            // NEW: Hide summary container
            if (this.summaryContainer) {
                this.summaryContainer.classList.add('hidden');
            }
            return;
        }

        // Get the data for the selected day type
        const data = metroDataManager.metroData[selectedDayType];

        if (!data) {
            this.showError('اطلاعاتی برای روز انتخابی یافت نشد.');
            return;
        }

        // Find the index of the selected station
        const stationIndex = data.stations.indexOf(selectedStation);

        if (stationIndex === -1) {
            this.showError('ایستگاه انتخاب شده در جدول زمانی یافت نشد.');
            return;
        }

        // Update current time
        const now = new Date();
        this.currentTime = [
            String(now.getHours()).padStart(2, '0'),
            String(now.getMinutes()).padStart(2, '0'),
            String(now.getSeconds()).padStart(2, '0')
        ].join(':');

        // Extract times for the selected station from all rows
        const direction1Times = data.timetable
            .map(row => row.dir1_times[stationIndex])
            .filter(time => time); // Filter out null/empty values

        const direction2Times = data.timetable
            .map(row => row.dir2_times[stationIndex])
            .filter(time => time); // Filter out null/empty values

        // NEW: Update the summary cards
        this.updateSummaryCards(direction1Times, direction2Times, data);

        // Create HTML cards for both directions (Full Timetable)
        const card1 = this.createStationCard(data.direction1_header, direction1Times, 'blue');
        const card2 = this.createStationCard(data.direction2_header, direction2Times, 'green');

        // Update the DOM
        this.scheduleContainer.innerHTML = card1 + card2;
    },

    /**
     * NEW: Updates the "Next 2 Trains" summary boxes with countdown
     * @param {string[]} direction1Times - Array of times for direction 1
     * @param {string[]} direction2Times - Array of times for direction 2
     * @param {object} data - The metro data object with headers
     */
    updateSummaryCards(direction1Times, direction2Times, data) {
        // --- Direction 1 ---
        this.summaryDir1.title.textContent = data.direction1_header;
        const nextTrainIndex1 = this.findNextTrainIndex(direction1Times);

        if (nextTrainIndex1 !== -1) {
            // Next train
            const nextTime1 = direction1Times[nextTrainIndex1];
            this.summaryDir1.nextTime.textContent = this.getDisplayTime(nextTime1);
            const minutes1 = this.calculateMinutesRemaining(nextTime1);
            this.summaryDir1.countdown.textContent = `${minutes1} دقیقه`;

            // 2nd Next train
            if (direction1Times.length > nextTrainIndex1 + 1) {
                const secondTime1 = direction1Times[nextTrainIndex1 + 1];
                this.summaryDir1.secondTime.textContent = this.getDisplayTime(secondTime1);
                const minutes2 = this.calculateMinutesRemaining(secondTime1);
                this.summaryDir1.secondCountdown.textContent = `${minutes2} دقیقه`;
            } else {
                this.summaryDir1.secondTime.textContent = "--:--";
                this.summaryDir1.secondCountdown.textContent = "-- دقیقه";
            }
        } else {
            // No more trains
            this.summaryDir1.nextTime.textContent = "--:--";
            this.summaryDir1.countdown.textContent = "-- دقیقه";
            this.summaryDir1.secondTime.textContent = "--:--";
            this.summaryDir1.secondCountdown.textContent = "-- دقیقه";
        }

        // --- Direction 2 ---
        this.summaryDir2.title.textContent = data.direction2_header;
        const nextTrainIndex2 = this.findNextTrainIndex(direction2Times);

        if (nextTrainIndex2 !== -1) {
            // Next train
            const nextTime2 = direction2Times[nextTrainIndex2];
            this.summaryDir2.nextTime.textContent = this.getDisplayTime(nextTime2);
            const minutes1 = this.calculateMinutesRemaining(nextTime2);
            this.summaryDir2.countdown.textContent = `${minutes1} دقیقه`;

            // 2nd Next train
            if (direction2Times.length > nextTrainIndex2 + 1) {
                const secondTime2 = direction2Times[nextTrainIndex2 + 1];
                this.summaryDir2.secondTime.textContent = this.getDisplayTime(secondTime2);
                const minutes2 = this.calculateMinutesRemaining(secondTime2);
                this.summaryDir2.secondCountdown.textContent = `${minutes2} دقیقه`;
            } else {
                this.summaryDir2.secondTime.textContent = "--:--";
                this.summaryDir2.secondCountdown.textContent = "-- دقیقه";
            }
        } else {
            // No more trains
            this.summaryDir2.nextTime.textContent = "--:--";
            this.summaryDir2.countdown.textContent = "-- دقیقه";
            this.summaryDir2.secondTime.textContent = "--:--";
            this.summaryDir2.secondCountdown.textContent = "-- دقیقه";
        }

        // Show the summary container
        if (this.summaryContainer) {
            this.summaryContainer.classList.remove('hidden');
        }
    },

    /**
     * Creates an HTML card for a single direction's FULL schedule
     * @param {string} title - The title for the card (e.g., direction name)
     * @param {string[]} times - An array of time strings (HH:MM:SS)
     * @param {string} themeColor - 'blue' or 'green' for highlighting
     * @returns {string} HTML string for the card
     */
    /**
     * Creates an HTML card for a single direction's FULL schedule with countdown
     * @param {string} title - The title for the card (e.g., direction name)
     * @param {string[]} times - An array of time strings (HH:MM:SS)
     * @param {string} themeColor - 'blue' or 'green' for highlighting
     * @returns {string} HTML string for the card
     */
    createStationCard(title, times, themeColor = 'blue') {
        if (times.length === 0) {
            return `
            <div class="bg-gray-800 rounded-lg shadow-lg overflow-hidden border border-gray-700">
                <div class="px-5 py-4 bg-gray-700/50">
                    <h3 class="text-lg font-semibold text-gray-100">${title}</h3>
                </div>
                <div class="p-5">
                    <p class="text-gray-400">اطلاعاتی برای این ایستگاه در این مسیر یافت نشد.</p>
                </div>
            </div>`;
        }

        // Find the index of the next train
        const nextTrainIndex = this.findNextTrainIndex(times);

        let timesHtml = '<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">';

        times.forEach((time, index) => {
            const isNextTrain = (index === nextTrainIndex);
            const isPastTrain = (index < nextTrainIndex);
            const minutesRemaining = this.calculateMinutesRemaining(time);

            let classes = "text-center rounded-md p-2 text-lg font-medium tabular-nums transition-colors ";
            let highlightClass = themeColor === 'blue' ? "bg-blue-600 text-white shadow-lg scale-105" : "bg-green-600 text-white shadow-lg scale-105";

            if (isNextTrain) {
                // Highlight the next train
                classes += highlightClass;
            } else if (isPastTrain) {
                // Dim past trains
                classes += "bg-gray-700/50 text-gray-500 line-through";
            } else {
                // Future trains
                classes += "bg-gray-700 text-gray-200";
            }

            timesHtml += `
                <div class="${classes}">
                    <div class="font-bold">${this.getDisplayTime(time)}</div>
                    <div class="text-xs mt-1 ${isNextTrain ? 'text-blue-100' : 'text-gray-400'}">
                        ${isPastTrain ? 'گذشته' : `${minutesRemaining} دقیقه`}
                    </div>
                </div>`;
        });

        timesHtml += '</div>';

        let cardHtml = `
            <div class="bg-gray-800 rounded-lg shadow-lg overflow-hidden border border-gray-700">
                <div class="px-5 py-4 bg-gray-700/50">
                    <h3 class="text-lg font-semibold text-gray-100">${title}</h3>
                </div>
                <div class="p-5">
                    ${timesHtml}
                </div>
            </div>
        `;
        return cardHtml;
    },

    /**
     * Finds the index of the next train in a sorted list of times
     * @param {string[]} times - Array of time strings
     * @returns {number} Index of the next train, or -1 if all have passed
     */
    findNextTrainIndex(times) {
        if (!this.currentTime) return -1;

        for (let i = 0; i < times.length; i++) {
            if (times[i] >= this.currentTime) {
                return i; // This is the next train
            }
        }
        return -1; // All trains for today have passed
    },

    /**
     * Formats a HH:MM:SS time string to HH:MM
     * @param {string} timeString - e.g., "07:30:00"
     * @returns {string} - e.g., "07:30"
     */
    getDisplayTime(timeString) {
        return timeString.substring(0, 5); // "HH:MM:SS" -> "HH:MM"
    },

    /**
     * Shows a loading message
     */
    showLoading() {
        if (this.loadingSpinner) this.loadingSpinner.classList.remove('hidden');
        this.scheduleContainer.innerHTML = '';
        if (this.initialMessage) this.initialMessage.classList.add('hidden');
    },

    /**
     * Hides the loading message
     */
    hideLoading() {
        if (this.loadingSpinner) this.loadingSpinner.classList.add('hidden');
    },

    /**
     * Displays an error message in the schedule container
     * @param {string} message - The error message to display
     */
    showError(message) {
        this.scheduleContainer.innerHTML = `
            <div class="bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded-lg shadow-lg" role="alert">
                <strong class="font-bold">خطا: </strong>
                <span class="block sm:inline">${message}</span>
            </div>
        `;
    }
};

// =====================================================================
// ||                      راه‌اندازی برنامه (Init)                       ||
// =====================================================================
document.addEventListener('DOMContentLoaded', () => {
    // Show loading spinner
    metroApp.showLoading();

    // Initialize modules (all local, no APIs)
    liveClock.init();
    persianCalendar.init();

    // Initialize the data manager (now synchronous)
    metroDataManager.init().then(() => {
        // Data is parsed, now init the main app
        if (metroDataManager.metroData.normal && metroDataManager.stationNames.length > 0) {
            metroApp.init(metroDataManager.stationNames);
            // Hide loading spinner
            metroApp.hideLoading();
            // Show the initial message
            if (metroApp.initialMessage) metroApp.initialMessage.classList.remove('hidden');
        } else {
            // Handle fatal error if data couldn't be loaded
            metroApp.hideLoading();
            metroApp.showError('خطای اساسی: جدول زمانی مترو بارگذاری نشد.');
        }
    });
});